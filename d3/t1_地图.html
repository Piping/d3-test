<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>t1_地图</title>
    <script src="d3.js"></script>
</head>
<body>
<script>
/*
 GeoJSON 文件中的地图数据，都是经度和纬度的信息。
 它们都是三维的，而要在网页上显示的是二维的，所以要设定一个投影函数来转换经度纬度。
 使用 d3.geo.mercator() 的投影方式。
 各种投影的函数，可以参考： https://github.com/mbostock/d3/wiki/Geo-Projections
*/ 
var width = 1200;
var height = 900;

var svg = d3.select("body")
        .append("svg")
        .attr("width", width)
        .attr("height", height).append("g")
    .attr("transform", "translate(0,0)");
var projection = d3.geo.mercator()
    .center([107, 31])//center() 设定地图的中心位置，[107,31] 指的是经度和纬度。
    .scale(1000)//scale() 设定放大的比例
    .translate([600, 550]);//translate() 设定平移
var path = d3.geo.path()
    .projection(projection);
//为了根据地图的地理数据生成 SVG 中 path 元素的路径值，需要用到 d3.geo.path()
//projection() 是设定生成器的投影函数，把上面定义的投影传入即可。
var color = d3.scale.category20();
d3.json("china.geojson", function(error, root) {
    if (error) 
        return console.error(error);
    console.log(root.features);
        
    svg.selectAll("path")
        .data( root.features )
        .enter()
        .append("path")
        .attr("stroke","#000")
        .attr("stroke-width",1)
        .attr("fill", function(d,i){
            return color(i);
        })
        .attr("d", path )   //使用地理路径生成器
        .on("mouseover",function(d,i){
                    d3.select(this)
                       .attr("fill","yellow");
                })
                .on("mouseout",function(d,i){
                    d3.select(this)
                       .attr("fill",color(i));
                });
});
</script>
</body>
</html>